# -----------------------------------------------------------------------------
# This file was generated by Chef.
# All manual changes will be overwritten during the next Chef run.
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
# General settings
# -----------------------------------------------------------------------------
export JAVA_HOME=<%= node['java']['java_home'] %>
<% if !node['cq']['custom_tmp_dir'].nil? && !node['cq']['custom_tmp_dir'].empty? %>
export CQ_TMP_DIR=<%= node['cq']['custom_tmp_dir'] %>
<% end %>

# -----------------------------------------------------------------------------
# CQ start file variables
# -----------------------------------------------------------------------------
export CQ_PORT=<%= @port %>
export CQ_USER=<%= node['cq']['user'] %>
export CQ_HOME=<%= @instance_home %>
export CQ_RUNMODE=<%= @mode %><% if node['cq']['mongo'] == true %>,crx3mongo<% end %>

# -----------------------------------------------------------------------------
# Core JVM parameters
# -----------------------------------------------------------------------------
CQ_MIN_HEAP=<%= @min_heap %>
CQ_MAX_HEAP=<%= @max_heap %>
CQ_MAX_PERMSIZE=<%= @max_perm_size %>
CQ_CODE_CACHE=<%= @code_cache %>

# -----------------------------------------------------------------------------
# JVM options
# -----------------------------------------------------------------------------
<% if !node['cq']['custom_tmp_dir'].nil? && !node['cq']['custom_tmp_dir'].empty? %>
CQ_GENERAL_OPTS="<%= @jvm_general_opts %> -Djava.io.tmpdir=${CQ_TMP_DIR}"
<% else %>
CQ_GENERAL_OPTS="<%= @jvm_general_opts %>"
<% end %>
<% if !@jvm_code_cache_opts.nil? && !@jvm_code_cache_opts.empty? %>
CQ_CODE_CACHE="-XX:ReservedCodeCacheSize=${CQ_CODE_CACHE}m <%= @jvm_code_cache_opts %>"
<% else %>
CQ_CODE_CACHE="-XX:ReservedCodeCacheSize=${CQ_CODE_CACHE}m"
<% end %>
CQ_GC_OPTS="<%= @jvm_gc_opts %>"
CQ_JMX_OPTS="<%= @jvm_jmx_opts %>"
CQ_DEBUG_OPTS="<%= @jvm_debug_opts %>"
CQ_EXTRA_OPTS="<%= @jvm_extra_opts %>"

# -----------------------------------------------------------------------------
# do not configure below this point
# -----------------------------------------------------------------------------
export CQ_JVM_OPTS="${CQ_GENERAL_OPTS} \
                    -Xms${CQ_MIN_HEAP}m \
                    -Xmx${CQ_MAX_HEAP}m \
                    -XX:MaxPermSize=${CQ_MAX_PERMSIZE}m \
                    ${CQ_CODE_CACHE} \
                    ${CQ_GC_OPTS} \
                    ${CQ_JMX_OPTS} \
                    ${CQ_DEBUG_OPTS} \
                    ${CQ_EXTRA_OPTS}"
